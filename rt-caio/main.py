import requests
import json
import pydicom
from lib.dicompylercore import dicomparser, dvh, dvhcalc

# payload = {

#     "path": "/var/data/dcm/prostate/CT.20190343_221.dcm"

# }

payload = {
    "files": {
        "CT_1": "/var/data/dcm/prostate/CT.20190343_1.dcm",
        "CT_2": "/var/data/dcm/prostate/CT.20190343_2.dcm",
        "CT_3": "/var/data/dcm/prostate/CT.20190343_3.dcm",
        "CT_4": "/var/data/dcm/prostate/CT.20190343_4.dcm",
        "CT_5": "/var/data/dcm/prostate/CT.20190343_5.dcm",
        "CT_6": "/var/data/dcm/prostate/CT.20190343_6.dcm",
        "CT_7": "/var/data/dcm/prostate/CT.20190343_7.dcm",
        "CT_8": "/var/data/dcm/prostate/CT.20190343_8.dcm",
        "CT_9": "/var/data/dcm/prostate/CT.20190343_9.dcm",
        "CT_10": "/var/data/dcm/prostate/CT.20190343_10.dcm",
        "CT_11": "/var/data/dcm/prostate/CT.20190343_11.dcm",
        "CT_12": "/var/data/dcm/prostate/CT.20190343_12.dcm",
        "CT_13": "/var/data/dcm/prostate/CT.20190343_13.dcm",
        "CT_14": "/var/data/dcm/prostate/CT.20190343_14.dcm",
        "CT_15": "/var/data/dcm/prostate/CT.20190343_15.dcm",
        "CT_16": "/var/data/dcm/prostate/CT.20190343_16.dcm",
        "CT_17": "/var/data/dcm/prostate/CT.20190343_17.dcm",
        "CT_18": "/var/data/dcm/prostate/CT.20190343_18.dcm",
        "CT_19": "/var/data/dcm/prostate/CT.20190343_19.dcm",
        "CT_20": "/var/data/dcm/prostate/CT.20190343_20.dcm",
        "CT_21": "/var/data/dcm/prostate/CT.20190343_21.dcm",
        "CT_22": "/var/data/dcm/prostate/CT.20190343_22.dcm",
        "CT_23": "/var/data/dcm/prostate/CT.20190343_23.dcm",
        "CT_24": "/var/data/dcm/prostate/CT.20190343_24.dcm",
        "CT_25": "/var/data/dcm/prostate/CT.20190343_25.dcm",
        "CT_26": "/var/data/dcm/prostate/CT.20190343_26.dcm",
        "CT_27": "/var/data/dcm/prostate/CT.20190343_27.dcm",
        "CT_28": "/var/data/dcm/prostate/CT.20190343_28.dcm",
        "CT_29": "/var/data/dcm/prostate/CT.20190343_29.dcm",
        "CT_30": "/var/data/dcm/prostate/CT.20190343_30.dcm",
        "CT_31": "/var/data/dcm/prostate/CT.20190343_31.dcm",
        "CT_32": "/var/data/dcm/prostate/CT.20190343_32.dcm",
        "CT_33": "/var/data/dcm/prostate/CT.20190343_33.dcm",
        "CT_34": "/var/data/dcm/prostate/CT.20190343_34.dcm",
        "CT_35": "/var/data/dcm/prostate/CT.20190343_35.dcm",
        "CT_36": "/var/data/dcm/prostate/CT.20190343_36.dcm",
        "CT_37": "/var/data/dcm/prostate/CT.20190343_37.dcm",
        "CT_38": "/var/data/dcm/prostate/CT.20190343_38.dcm",
        "CT_39": "/var/data/dcm/prostate/CT.20190343_39.dcm",
        "CT_40": "/var/data/dcm/prostate/CT.20190343_40.dcm",
        "CT_41": "/var/data/dcm/prostate/CT.20190343_41.dcm",
        "CT_42": "/var/data/dcm/prostate/CT.20190343_42.dcm",
        "CT_43": "/var/data/dcm/prostate/CT.20190343_43.dcm",
        "CT_44": "/var/data/dcm/prostate/CT.20190343_44.dcm",
        "CT_45": "/var/data/dcm/prostate/CT.20190343_45.dcm",
        "CT_46": "/var/data/dcm/prostate/CT.20190343_46.dcm",
        "CT_47": "/var/data/dcm/prostate/CT.20190343_47.dcm",
        "CT_48": "/var/data/dcm/prostate/CT.20190343_48.dcm",
        "CT_49": "/var/data/dcm/prostate/CT.20190343_49.dcm",
        "CT_50": "/var/data/dcm/prostate/CT.20190343_50.dcm",
        "CT_51": "/var/data/dcm/prostate/CT.20190343_51.dcm",
        "CT_52": "/var/data/dcm/prostate/CT.20190343_52.dcm",
        "CT_53": "/var/data/dcm/prostate/CT.20190343_53.dcm",
        "CT_54": "/var/data/dcm/prostate/CT.20190343_54.dcm",
        "CT_55": "/var/data/dcm/prostate/CT.20190343_55.dcm",
        "CT_56": "/var/data/dcm/prostate/CT.20190343_56.dcm",
        "CT_57": "/var/data/dcm/prostate/CT.20190343_57.dcm",
        "CT_58": "/var/data/dcm/prostate/CT.20190343_58.dcm",
        "CT_59": "/var/data/dcm/prostate/CT.20190343_59.dcm",
        "CT_60": "/var/data/dcm/prostate/CT.20190343_60.dcm",
        "CT_61": "/var/data/dcm/prostate/CT.20190343_61.dcm",
        "CT_62": "/var/data/dcm/prostate/CT.20190343_62.dcm",
        "CT_63": "/var/data/dcm/prostate/CT.20190343_63.dcm",
        "CT_64": "/var/data/dcm/prostate/CT.20190343_64.dcm",
        "CT_65": "/var/data/dcm/prostate/CT.20190343_65.dcm",
        "CT_66": "/var/data/dcm/prostate/CT.20190343_66.dcm",
        "CT_67": "/var/data/dcm/prostate/CT.20190343_67.dcm",
        "CT_68": "/var/data/dcm/prostate/CT.20190343_68.dcm",
        "CT_69": "/var/data/dcm/prostate/CT.20190343_69.dcm",
        "CT_70": "/var/data/dcm/prostate/CT.20190343_70.dcm",
        "CT_71": "/var/data/dcm/prostate/CT.20190343_71.dcm",
        "CT_72": "/var/data/dcm/prostate/CT.20190343_72.dcm",
        "CT_73": "/var/data/dcm/prostate/CT.20190343_73.dcm",
        "CT_74": "/var/data/dcm/prostate/CT.20190343_74.dcm",
        "CT_75": "/var/data/dcm/prostate/CT.20190343_75.dcm",
        "CT_76": "/var/data/dcm/prostate/CT.20190343_76.dcm",
        "CT_77": "/var/data/dcm/prostate/CT.20190343_77.dcm",
        "CT_78": "/var/data/dcm/prostate/CT.20190343_78.dcm",
        "CT_79": "/var/data/dcm/prostate/CT.20190343_79.dcm",
        "CT_80": "/var/data/dcm/prostate/CT.20190343_80.dcm",
        "CT_81": "/var/data/dcm/prostate/CT.20190343_81.dcm",
        "CT_82": "/var/data/dcm/prostate/CT.20190343_82.dcm",
        "CT_83": "/var/data/dcm/prostate/CT.20190343_83.dcm",
        "CT_84": "/var/data/dcm/prostate/CT.20190343_84.dcm",
        "CT_85": "/var/data/dcm/prostate/CT.20190343_85.dcm",
        "CT_86": "/var/data/dcm/prostate/CT.20190343_86.dcm",
        "CT_87": "/var/data/dcm/prostate/CT.20190343_87.dcm",
        "CT_88": "/var/data/dcm/prostate/CT.20190343_88.dcm",
        "CT_89": "/var/data/dcm/prostate/CT.20190343_89.dcm",
        "CT_90": "/var/data/dcm/prostate/CT.20190343_90.dcm",
        "CT_91": "/var/data/dcm/prostate/CT.20190343_91.dcm",
        "CT_92": "/var/data/dcm/prostate/CT.20190343_92.dcm",
        "CT_93": "/var/data/dcm/prostate/CT.20190343_93.dcm",
        "CT_94": "/var/data/dcm/prostate/CT.20190343_94.dcm",
        "CT_95": "/var/data/dcm/prostate/CT.20190343_95.dcm",
        "CT_96": "/var/data/dcm/prostate/CT.20190343_96.dcm",
        "CT_97": "/var/data/dcm/prostate/CT.20190343_97.dcm",
        "CT_98": "/var/data/dcm/prostate/CT.20190343_98.dcm",
        "CT_99": "/var/data/dcm/prostate/CT.20190343_99.dcm",
        "CT_100": "/var/data/dcm/prostate/CT.20190343_100.dcm",
        "CT_101": "/var/data/dcm/prostate/CT.20190343_101.dcm",
        "CT_102": "/var/data/dcm/prostate/CT.20190343_102.dcm",
        "CT_103": "/var/data/dcm/prostate/CT.20190343_103.dcm",
        "CT_104": "/var/data/dcm/prostate/CT.20190343_104.dcm",
        "CT_105": "/var/data/dcm/prostate/CT.20190343_105.dcm",
        "CT_106": "/var/data/dcm/prostate/CT.20190343_106.dcm",
        "CT_107": "/var/data/dcm/prostate/CT.20190343_107.dcm",
        "CT_108": "/var/data/dcm/prostate/CT.20190343_108.dcm",
        "CT_109": "/var/data/dcm/prostate/CT.20190343_109.dcm",
        "CT_110": "/var/data/dcm/prostate/CT.20190343_110.dcm",
        "CT_111": "/var/data/dcm/prostate/CT.20190343_111.dcm",
        "CT_112": "/var/data/dcm/prostate/CT.20190343_112.dcm",
        "CT_113": "/var/data/dcm/prostate/CT.20190343_113.dcm",
        "CT_114": "/var/data/dcm/prostate/CT.20190343_114.dcm",
        "CT_115": "/var/data/dcm/prostate/CT.20190343_115.dcm",
        "CT_116": "/var/data/dcm/prostate/CT.20190343_116.dcm",
        "CT_117": "/var/data/dcm/prostate/CT.20190343_117.dcm",
        "CT_118": "/var/data/dcm/prostate/CT.20190343_118.dcm",
        "CT_119": "/var/data/dcm/prostate/CT.20190343_119.dcm",
        "CT_120": "/var/data/dcm/prostate/CT.20190343_120.dcm",
        "CT_121": "/var/data/dcm/prostate/CT.20190343_121.dcm",
        "CT_122": "/var/data/dcm/prostate/CT.20190343_122.dcm",
        "CT_123": "/var/data/dcm/prostate/CT.20190343_123.dcm",
        "CT_124": "/var/data/dcm/prostate/CT.20190343_124.dcm",
        "CT_125": "/var/data/dcm/prostate/CT.20190343_125.dcm",
        "CT_126": "/var/data/dcm/prostate/CT.20190343_126.dcm",
        "CT_127": "/var/data/dcm/prostate/CT.20190343_127.dcm",
        "CT_128": "/var/data/dcm/prostate/CT.20190343_128.dcm",
        "CT_129": "/var/data/dcm/prostate/CT.20190343_129.dcm",
        "CT_130": "/var/data/dcm/prostate/CT.20190343_130.dcm",
        "CT_131": "/var/data/dcm/prostate/CT.20190343_131.dcm",
        "CT_132": "/var/data/dcm/prostate/CT.20190343_132.dcm",
        "CT_133": "/var/data/dcm/prostate/CT.20190343_133.dcm",
        "CT_134": "/var/data/dcm/prostate/CT.20190343_134.dcm",
        "CT_135": "/var/data/dcm/prostate/CT.20190343_135.dcm",
        "CT_136": "/var/data/dcm/prostate/CT.20190343_136.dcm",
        "CT_137": "/var/data/dcm/prostate/CT.20190343_137.dcm",
        "CT_138": "/var/data/dcm/prostate/CT.20190343_138.dcm",
        "CT_139": "/var/data/dcm/prostate/CT.20190343_139.dcm",
        "CT_140": "/var/data/dcm/prostate/CT.20190343_140.dcm",
        "CT_141": "/var/data/dcm/prostate/CT.20190343_141.dcm",
        "CT_142": "/var/data/dcm/prostate/CT.20190343_142.dcm",
        "CT_143": "/var/data/dcm/prostate/CT.20190343_143.dcm",
        "CT_144": "/var/data/dcm/prostate/CT.20190343_144.dcm",
        "CT_145": "/var/data/dcm/prostate/CT.20190343_145.dcm",
        "CT_146": "/var/data/dcm/prostate/CT.20190343_146.dcm",
        "CT_147": "/var/data/dcm/prostate/CT.20190343_147.dcm",
        "CT_148": "/var/data/dcm/prostate/CT.20190343_148.dcm",
        "CT_149": "/var/data/dcm/prostate/CT.20190343_149.dcm",
        "CT_150": "/var/data/dcm/prostate/CT.20190343_150.dcm",
        "CT_151": "/var/data/dcm/prostate/CT.20190343_151.dcm",
        "CT_152": "/var/data/dcm/prostate/CT.20190343_152.dcm",
        "CT_153": "/var/data/dcm/prostate/CT.20190343_153.dcm",
        "CT_154": "/var/data/dcm/prostate/CT.20190343_154.dcm",
        "CT_155": "/var/data/dcm/prostate/CT.20190343_155.dcm",
        "CT_156": "/var/data/dcm/prostate/CT.20190343_156.dcm",
        "CT_157": "/var/data/dcm/prostate/CT.20190343_157.dcm",
        "CT_158": "/var/data/dcm/prostate/CT.20190343_158.dcm",
        "CT_159": "/var/data/dcm/prostate/CT.20190343_159.dcm",
        "CT_160": "/var/data/dcm/prostate/CT.20190343_160.dcm",
        "CT_161": "/var/data/dcm/prostate/CT.20190343_161.dcm",
        "CT_162": "/var/data/dcm/prostate/CT.20190343_162.dcm",
        "CT_163": "/var/data/dcm/prostate/CT.20190343_163.dcm",
        "CT_164": "/var/data/dcm/prostate/CT.20190343_164.dcm",
        "CT_165": "/var/data/dcm/prostate/CT.20190343_165.dcm",
        "CT_166": "/var/data/dcm/prostate/CT.20190343_166.dcm",
        "CT_167": "/var/data/dcm/prostate/CT.20190343_167.dcm",
        "CT_168": "/var/data/dcm/prostate/CT.20190343_168.dcm",
        "CT_169": "/var/data/dcm/prostate/CT.20190343_169.dcm",
        "CT_170": "/var/data/dcm/prostate/CT.20190343_170.dcm",
        "CT_171": "/var/data/dcm/prostate/CT.20190343_171.dcm",
        "CT_172": "/var/data/dcm/prostate/CT.20190343_172.dcm",
        "CT_173": "/var/data/dcm/prostate/CT.20190343_173.dcm",
        "CT_174": "/var/data/dcm/prostate/CT.20190343_174.dcm",
        "CT_175": "/var/data/dcm/prostate/CT.20190343_175.dcm",
        "CT_176": "/var/data/dcm/prostate/CT.20190343_176.dcm",
        "CT_177": "/var/data/dcm/prostate/CT.20190343_177.dcm",
        "CT_178": "/var/data/dcm/prostate/CT.20190343_178.dcm",
        "CT_179": "/var/data/dcm/prostate/CT.20190343_179.dcm",
        "CT_180": "/var/data/dcm/prostate/CT.20190343_180.dcm",
        "CT_181": "/var/data/dcm/prostate/CT.20190343_181.dcm",
        "CT_182": "/var/data/dcm/prostate/CT.20190343_182.dcm",
        "CT_183": "/var/data/dcm/prostate/CT.20190343_183.dcm",
        "CT_184": "/var/data/dcm/prostate/CT.20190343_184.dcm",
        "CT_185": "/var/data/dcm/prostate/CT.20190343_185.dcm",
        "CT_186": "/var/data/dcm/prostate/CT.20190343_186.dcm",
        "CT_187": "/var/data/dcm/prostate/CT.20190343_187.dcm",
        "CT_188": "/var/data/dcm/prostate/CT.20190343_188.dcm",
        "CT_189": "/var/data/dcm/prostate/CT.20190343_189.dcm",
        "CT_190": "/var/data/dcm/prostate/CT.20190343_190.dcm",
        "CT_191": "/var/data/dcm/prostate/CT.20190343_191.dcm",
        "CT_192": "/var/data/dcm/prostate/CT.20190343_192.dcm",
        "CT_193": "/var/data/dcm/prostate/CT.20190343_193.dcm",
        "CT_194": "/var/data/dcm/prostate/CT.20190343_194.dcm",
        "CT_195": "/var/data/dcm/prostate/CT.20190343_195.dcm",
        "CT_196": "/var/data/dcm/prostate/CT.20190343_196.dcm",
        "CT_197": "/var/data/dcm/prostate/CT.20190343_197.dcm",
        "CT_198": "/var/data/dcm/prostate/CT.20190343_198.dcm",
        "CT_199": "/var/data/dcm/prostate/CT.20190343_199.dcm",
        "CT_200": "/var/data/dcm/prostate/CT.20190343_200.dcm",
        "CT_202": "/var/data/dcm/prostate/CT.20190343_202.dcm",
        "CT_203": "/var/data/dcm/prostate/CT.20190343_203.dcm",
        "CT_204": "/var/data/dcm/prostate/CT.20190343_204.dcm",
        "CT_205": "/var/data/dcm/prostate/CT.20190343_205.dcm",
        "CT_206": "/var/data/dcm/prostate/CT.20190343_206.dcm",
        "CT_207": "/var/data/dcm/prostate/CT.20190343_207.dcm",
        "CT_208": "/var/data/dcm/prostate/CT.20190343_208.dcm",
        "CT_209": "/var/data/dcm/prostate/CT.20190343_209.dcm",
        "CT_210": "/var/data/dcm/prostate/CT.20190343_210.dcm",
        "CT_211": "/var/data/dcm/prostate/CT.20190343_211.dcm",
        "CT_212": "/var/data/dcm/prostate/CT.20190343_212.dcm",
        "CT_213": "/var/data/dcm/prostate/CT.20190343_213.dcm",
        "CT_214": "/var/data/dcm/prostate/CT.20190343_214.dcm",
        "CT_215": "/var/data/dcm/prostate/CT.20190343_215.dcm",
        "CT_216": "/var/data/dcm/prostate/CT.20190343_216.dcm",
        "CT_217": "/var/data/dcm/prostate/CT.20190343_217.dcm",
        "CT_218": "/var/data/dcm/prostate/CT.20190343_218.dcm",
        "CT_219": "/var/data/dcm/prostate/CT.20190343_219.dcm",
        "CT_220": "/var/data/dcm/prostate/CT.20190343_220.dcm",
        "CT_221": "/var/data/dcm/prostate/CT.20190343_221.dcm",
        "CT_514": "/var/data/dcm/prostate/CT.20190343_514.dcm",
        "RD": "/var/data/dcm/prostate/RD.20190343_.dcm",
        "RI1": "/var/data/dcm/prostate/RI.20190343_7_227.dcm",
        "RI2": "/var/data/dcm/prostate/RI.20190343_7_228.dcm",
        "RI3": "/var/data/dcm/prostate/RI.20190343_7_229.dcm",
        "RI4": "/var/data/dcm/prostate/RI.20190343_7_230.dcm",
        "RI5": "/var/data/dcm/prostate/RI.20190343_7_231.dcm",
        "RI6": "/var/data/dcm/prostate/RI.20190343_7_232.dcm",
        "RI7": "/var/data/dcm/prostate/RI.20190343_7_233.dcm",
        "RP": "/var/data/dcm/prostate/RP.20190343_FASE UNICA.dcm",
        "RS": "/var/data/dcm/prostate/RS.20190343_.dcm"
    }
}


# TESTE DE TIPO DO VALUE
# for key, value in payload["files"].items():
#     print("KEY", key ," ---> Tipo :", type(value))

payloadJson = json.dumps(payload)


def fetch_data(endpoint, payload):
    if endpoint == "contour":
        url = "http://localhost:9999/contour/"
    else:
        url = "http://localhost:9999/isodose/"

    try:
        #response = requests.post(url, data={"data": json.dumps(payload)})
        #response = requests.post(url, data = payloadJson)
        response = requests.post(url, data={"data": payloadJson})
        #response = requests.post(url, json=payload)
        print("\nStatus de Acesso:", response.status_code, "\n")

        try:
            json_data = response.json()
            print("\nüì¶ Resposta JSON:\n", json.dumps(json_data, indent=2))
            return json_data
            
        except json.JSONDecodeError:
            print("‚ùå Resposta n√£o √© JSON v√°lida.")
            #print("Resposta bruta:\n", response.text)
            return None

        
    except requests.exceptions.RequestException as e:
        print(f"‚ùå Erro na requisi√ß√£o: {e}")
        return None
    
RespostaApi = fetch_data("isodose", payload)